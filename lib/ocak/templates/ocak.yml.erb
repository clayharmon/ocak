# Ocak pipeline configuration
# Generated by `ocak init` — customize as needed

# Auto-detected project stack
stack:
  language: <%= language %>
<%- if framework -%>
  framework: <%= framework %>
<%- end -%>
<%- if test_command -%>
  test_command: "<%= test_command %>"
<%- end -%>
<%- if lint_command -%>
  lint_command: "<%= lint_command %>"
<%- end -%>
<%- if setup_command -%>
  setup_command: "<%= setup_command %>"
<%- end -%>
<%- if format_command -%>
  format_command: "<%= format_command %>"
<%- end -%>
<%- unless security_commands.empty? -%>
  security_commands:
<%- security_commands.each do |cmd| -%>
    - "<%= cmd %>"
<%- end -%>
<%- end -%>

# Pipeline settings
pipeline:
  max_parallel: 3
  poll_interval: 60
  worktree_dir: ".claude/worktrees"
  log_dir: "logs/pipeline"

# GitHub label state machine
labels:
  ready: "auto-ready"
  in_progress: "in-progress"
  completed: "completed"
  failed: "pipeline-failed"

# Pipeline steps — customize by adding/removing/reordering
steps:
  - agent: implementer
    role: implement
  - agent: reviewer
    role: review
  - agent: implementer
    role: fix
    condition: has_findings
  - agent: reviewer
    role: verify
    condition: had_fixes
  - agent: security_reviewer
    role: security
  - agent: implementer
    role: fix
    condition: has_findings
  - agent: documenter
    role: document
  - agent: auditor
    role: audit
  - agent: merger
    role: merge

# Agent file paths — override to use custom agents
agents:
  implementer: .claude/agents/implementer.md
  reviewer: .claude/agents/reviewer.md
  security_reviewer: .claude/agents/security-reviewer.md
  documenter: .claude/agents/documenter.md
  merger: .claude/agents/merger.md
  pipeline: .claude/agents/pipeline.md
  planner: .claude/agents/planner.md
  auditor: .claude/agents/auditor.md
